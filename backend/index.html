<!DOCTYPE html>
<html>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script>
      function getImage(){

      var spruch = document.getElementById("spruch").value;
      var produktlink = encodeURI(document.getElementById("produktlink").value);
      console.log(spruch);
      console.log(produktlink);
      var url =
        "http://127.0.0.1:5000/generate?spruch="+spruch+"&link=" + produktlink;
      var options = {
        method: "GET",
        mode: "cors",
        cache: "default",
      };
      var request = new Request(url);

      fetch(request, options).then((response) => {
        response.arrayBuffer().then((buffer) => {
          var base64Flag = "data:image/jpeg;base64,";
          var imageStr = arrayBufferToBase64(buffer);

          document.querySelector("img").src = base64Flag + imageStr;
        });
      });

      function arrayBufferToBase64(buffer) {
        var binary = "";
        var bytes = [].slice.call(new Uint8Array(buffer));

        bytes.forEach((b) => (binary += String.fromCharCode(b)));

        return window.btoa(binary);
      }
    }
    </script>
  </head>
  <body>
    
    <label for="fname">Galaxus f√ºr...</label>
    <input type="text" id="spruch" name="spruch" /><br /><br />
    <label for="lname">Produktlink</label>
    <input type="text" id="produktlink" name="produktlink" /><br /><br />

    <button onclick="getImage()">Generieren</button>
    <br />
    <img src="horer.jpeg" id="bild" height="600" width="450" />
  </body>
</html>
